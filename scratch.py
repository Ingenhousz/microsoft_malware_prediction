from util import *

# %% read in data
"""
with timer('write to pickle'):
    write_to_pickle(train, test)
"""
debug = True
with timer("read in files"):
    if debug:
        train, test = read_files(debug)
    else:
        train, test = read_pickle()
    train, test = drop_useless(train, test)

with timer('convert data to sparse matrix'):
    y_train, train_ids, test_ids, train, test = transfer_sparse(train, test)

with timer('one hot encoding'):
    train, test, m = one_hot(train, test)

with timer('build LGBM model'):
    counter, lgb_test_result = k_fold_lgbm(train, test, y_train, train_ids, test_ids, m)

with timer('generate submission files'):
    save_submission(lgb_test_result, counter)
