from util import *


# %% read in data
def main(debug=True):

    with timer("read in engineered features"):

        train, test, y_train, train_ids, test_ids, m = read_from_pickle('input/engineered_features.pkl')

    with timer('build lgbm model'):
        lgb_train_result, lgb_test_result, score = k_fold_lgbm(train, test, y_train, train_ids, test_ids, m, debug)

    with timer('generate submission files'):
        print('lgbm:', score)
        data = [lgb_train_result, lgb_test_result]
        save_to_pickle(data, 'input/meta_lgbm.pkl')
        if not debug:
            save_submission(lgb_test_result, score, 'lgbm')


if __name__ == '__main__':
    main(debug=False)
