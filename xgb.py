from util import *


# %% read in data
def main(debug=True):

    with timer("read in engineered features"):

        train, test, y_train, train_ids, test_ids, m = read_from_pickle('input/engineered_features.pkl')

    with timer('build lgbm model'):
        xgb_train_result, xgb_test_result, score = k_fold_xgb(train, test, y_train, train_ids, test_ids, m, debug)

    with timer('generate submission files'):
        print('xgb:', score)
        data = [xgb_train_result, xgb_test_result]
        save_to_pickle(data, 'input/meta_xgb.pkl')
        if not debug:
            save_submission(xgb_test_result, score, 'xgb')


if __name__ == '__main__':
    main(debug=False)
